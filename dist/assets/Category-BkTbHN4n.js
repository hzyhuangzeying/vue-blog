import{_ as R,k as P,u as U,r as g,i as C,o as $,j,a as i,c as v,b as u,d,t as w,e as l,w as f,h as F,F as E,f as L,g as M}from"./index-DoAYnoBG.js";import{u as T}from"./articles-aqgRK6Hw.js";import{A as q}from"./ArticleCard-BnejBbSa.js";import"./zh-CN-ZPh2jKaf.js";const G={class:"category-page"},H={class:"category-container"},J={class:"category-header"},K={class:"page-title"},O={class:"page-subtitle"},Q={class:"category-filters"},W={key:0,class:"loading-container"},X={key:1,class:"empty-container"},Y={key:2,class:"articles-grid"},Z={class:"pagination-container"},ee={__name:"Category",setup(te){const m=P(),b=U(),_=T(),r=g([]),y=g(!1),h=g("latest"),c=g(1),p=g(12),A=C(()=>{const t=m.params.id,e=_.categories.find(o=>o.id===parseInt(t));return e?e.name:"未知分类"}),z=C(()=>{let t=[...r.value];switch(h.value){case"views":t.sort((s,a)=>a.views-s.views);break;case"likes":t.sort((s,a)=>a.likes-s.likes);break;case"comments":t.sort((s,a)=>a.comments-s.comments);break;case"latest":default:t.sort((s,a)=>new Date(a.createdAt)-new Date(s.createdAt));break}const e=(c.value-1)*p.value,o=e+p.value;return t.slice(e,o)});$(async()=>{await k()}),j(()=>m.params.id,async()=>{await k()});const k=async()=>{y.value=!0;try{const[t,e]=await Promise.all([_.fetchArticles(),_.fetchCategories()]);if(t.success&&e.success){const o=m.params.id,s=e.data.find(a=>a.id===parseInt(o));s?r.value=t.data.filter(a=>a.category===s.name):r.value=[]}}finally{y.value=!1}},S=()=>{c.value=1},V=t=>{p.value=t,c.value=1},x=t=>{c.value=t},B=t=>{b.push({name:"ArticleDetail",params:{id:t.id}})};return(t,e)=>{const o=i("el-option"),s=i("el-select"),a=i("el-skeleton"),I=i("el-button"),D=i("el-empty"),N=i("el-pagination");return u(),v("div",G,[d("div",H,[d("div",J,[d("h1",K,w(A.value),1),d("p",O,"共 "+w(r.value.length)+" 篇文章",1)]),d("div",Q,[l(s,{modelValue:h.value,"onUpdate:modelValue":e[0]||(e[0]=n=>h.value=n),placeholder:"排序方式",onChange:S},{default:f(()=>[l(o,{label:"最新发布",value:"latest"}),l(o,{label:"最多阅读",value:"views"}),l(o,{label:"最多点赞",value:"likes"}),l(o,{label:"最多评论",value:"comments"})]),_:1},8,["modelValue"])]),y.value?(u(),v("div",W,[l(a,{rows:5,animated:""})])):r.value.length===0?(u(),v("div",X,[l(D,{description:"该分类下暂无文章"},{default:f(()=>[l(I,{type:"primary",onClick:e[1]||(e[1]=n=>t.$router.push("/articles"))},{default:f(()=>[...e[4]||(e[4]=[F(" 浏览所有文章 ",-1)])]),_:1})]),_:1})])):(u(),v("div",Y,[(u(!0),v(E,null,L(z.value,n=>(u(),M(q,{key:n.id,article:n,onClick:ae=>B(n)},null,8,["article","onClick"]))),128))])),d("div",Z,[l(N,{"current-page":c.value,"onUpdate:currentPage":e[2]||(e[2]=n=>c.value=n),"page-size":p.value,"onUpdate:pageSize":e[3]||(e[3]=n=>p.value=n),"page-sizes":[12,24,48],total:r.value.length,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:V,onCurrentChange:x},null,8,["current-page","page-size","total"])])])])}}},re=R(ee,[["__scopeId","data-v-a212e6ea"]]);export{re as default};
