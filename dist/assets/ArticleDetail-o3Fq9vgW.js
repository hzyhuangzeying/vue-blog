import{_ as P,k as Q,u as W,r as h,i as X,o as Y,a as i,c as u,b as d,e,d as t,l as Z,w as a,h as c,t as l,F as y,f as C,g as tt,E as p}from"./index-DoAYnoBG.js";import{u as et}from"./articles-aqgRK6Hw.js";import{f as st,z as at}from"./zh-CN-ZPh2jKaf.js";const ot={class:"article-detail"},nt={key:0,class:"loading-container"},lt={key:1,class:"article-content"},ct={class:"article-header"},it={class:"article-meta"},rt={class:"article-title"},dt={class:"article-info"},ut={class:"author-section"},_t={class:"author-details"},mt={class:"author-name"},vt={class:"publish-time"},ht={class:"article-stats"},pt={class:"stat-item"},ft={class:"stat-item"},kt={class:"stat-item"},gt={class:"article-tags"},wt={key:0,class:"article-cover"},bt=["src","alt"],yt={class:"article-body"},Ct=["innerHTML"],St={class:"article-actions"},Dt={class:"related-articles"},xt={class:"related-list"},At=["onClick"],$t=["src","alt"],Vt={class:"related-content"},zt={class:"related-title"},Nt={class:"related-meta"},Rt={class:"comments-section"},Tt={class:"section-title"},Bt={class:"comment-form"},It={class:"comment-actions"},Lt={class:"comments-list"},Mt={class:"comment-content"},Et={class:"comment-header"},Ot={class:"comment-author"},Ft={class:"comment-time"},Ht={class:"comment-text"},Ut={class:"comment-actions"},jt={key:2,class:"error-container"},qt={__name:"ArticleDetail",setup(Gt){const V=Q(),z=W(),S=et(),o=h(null),k=h(!1),v=h(""),g=h([]),D=h([]),N=X(()=>o.value?o.value.content.replace(/^# (.*$)/gim,"<h1>$1</h1>").replace(/^## (.*$)/gim,"<h2>$1</h2>").replace(/^### (.*$)/gim,"<h3>$1</h3>").replace(/\*\*(.*)\*\*/gim,"<strong>$1</strong>").replace(/\*(.*)\*/gim,"<em>$1</em>").replace(/\n/gim,"<br>"):"");Y(async()=>{await R(),await T(),await B()});const R=async()=>{k.value=!0;try{const r=await S.fetchArticleDetail(V.params.id);r.success&&(o.value=r.data)}finally{k.value=!1}},T=async()=>{const r=await S.fetchArticles();r.success&&(D.value=r.data.filter(s=>{var f;return s.id!==((f=o.value)==null?void 0:f.id)}).slice(0,4))},B=()=>{g.value=[{id:1,content:"这篇文章写得很好，学到了很多！",author:{nickname:"用户1",avatar:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png"},createdAt:new Date(Date.now()-2*60*60*1e3).toISOString()},{id:2,content:"感谢分享，期待更多这样的好文章。",author:{nickname:"用户2",avatar:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png"},createdAt:new Date(Date.now()-5*60*60*1e3).toISOString()}]},w=r=>{const s=new Date(r);return st(s,{addSuffix:!0,locale:at})},I=()=>{p.success("点赞成功！"),o.value.likes++},L=()=>{p.info("分享功能开发中...")},M=()=>{p.success("收藏成功！")},E=r=>{z.push({name:"ArticleDetail",params:{id:r.id}})},O=()=>{if(!v.value.trim()){p.warning("请输入评论内容");return}const r={id:Date.now(),content:v.value,author:{nickname:"当前用户",avatar:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png"},createdAt:new Date().toISOString()};g.value.unshift(r),v.value="",o.value.comments++,p.success("评论发表成功！")};return(r,s)=>{const f=i("el-skeleton"),x=i("router-link"),b=i("el-breadcrumb-item"),F=i("el-breadcrumb"),A=i("el-avatar"),H=i("View"),m=i("el-icon"),$=i("Star"),U=i("ChatDotRound"),j=i("el-tag"),_=i("el-button"),q=i("Share"),G=i("Collection"),J=i("el-input"),K=i("el-result");return d(),u("div",ot,[k.value?(d(),u("div",nt,[e(f,{rows:10,animated:""})])):o.value?(d(),u("div",lt,[t("header",ct,[t("div",it,[e(F,{separator:"/"},{default:a(()=>[e(b,null,{default:a(()=>[e(x,{to:"/home"},{default:a(()=>[...s[2]||(s[2]=[c("首页",-1)])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(x,{to:"/articles"},{default:a(()=>[...s[3]||(s[3]=[c("文章",-1)])]),_:1})]),_:1}),e(b,null,{default:a(()=>[c(l(o.value.category),1)]),_:1})]),_:1})]),t("h1",rt,l(o.value.title),1),t("div",dt,[t("div",ut,[e(A,{src:o.value.author.avatar,size:40},{default:a(()=>[c(l(o.value.author.nickname.charAt(0)),1)]),_:1},8,["src"]),t("div",_t,[t("div",mt,l(o.value.author.nickname),1),t("div",vt,l(w(o.value.createdAt)),1)])]),t("div",ht,[t("span",pt,[e(m,null,{default:a(()=>[e(H)]),_:1}),c(" "+l(o.value.views)+" 阅读 ",1)]),t("span",ft,[e(m,null,{default:a(()=>[e($)]),_:1}),c(" "+l(o.value.likes)+" 点赞 ",1)]),t("span",kt,[e(m,null,{default:a(()=>[e(U)]),_:1}),c(" "+l(o.value.comments)+" 评论 ",1)])])]),t("div",gt,[(d(!0),u(y,null,C(o.value.tags,n=>(d(),tt(j,{key:n,class:"tag"},{default:a(()=>[c(l(n),1)]),_:2},1024))),128))])]),o.value.cover?(d(),u("div",wt,[t("img",{src:o.value.cover,alt:o.value.title},null,8,bt)])):Z("",!0),t("div",yt,[t("div",{class:"markdown-content",innerHTML:N.value},null,8,Ct)]),t("div",St,[e(_,{type:"primary",onClick:I},{default:a(()=>[e(m,null,{default:a(()=>[e($)]),_:1}),c(" 点赞 "+l(o.value.likes),1)]),_:1}),e(_,{onClick:L},{default:a(()=>[e(m,null,{default:a(()=>[e(q)]),_:1}),s[4]||(s[4]=c(" 分享 ",-1))]),_:1}),e(_,{onClick:M},{default:a(()=>[e(m,null,{default:a(()=>[e(G)]),_:1}),s[5]||(s[5]=c(" 收藏 ",-1))]),_:1})]),t("div",Dt,[s[6]||(s[6]=t("h3",{class:"section-title"},"相关文章",-1)),t("div",xt,[(d(!0),u(y,null,C(D.value,n=>(d(),u("div",{key:n.id,class:"related-item",onClick:Jt=>E(n)},[t("img",{src:n.cover,alt:n.title},null,8,$t),t("div",Vt,[t("h4",zt,l(n.title),1),t("div",Nt,[t("span",null,l(n.views)+" 阅读",1),t("span",null,l(w(n.createdAt)),1)])])],8,At))),128))])]),t("div",Rt,[t("h3",Tt,"评论 ("+l(o.value.comments)+")",1),t("div",Bt,[e(J,{modelValue:v.value,"onUpdate:modelValue":s[0]||(s[0]=n=>v.value=n),type:"textarea",rows:4,placeholder:"写下你的评论...",maxlength:"500","show-word-limit":""},null,8,["modelValue"]),t("div",It,[e(_,{type:"primary",onClick:O},{default:a(()=>[...s[7]||(s[7]=[c(" 发表评论 ",-1)])]),_:1})])]),t("div",Lt,[(d(!0),u(y,null,C(g.value,n=>(d(),u("div",{key:n.id,class:"comment-item"},[e(A,{src:n.author.avatar,size:32},{default:a(()=>[c(l(n.author.nickname.charAt(0)),1)]),_:2},1032,["src"]),t("div",Mt,[t("div",Et,[t("span",Ot,l(n.author.nickname),1),t("span",Ft,l(w(n.createdAt)),1)]),t("div",Ht,l(n.content),1),t("div",Ut,[e(_,{type:"text",size:"small"},{default:a(()=>[...s[8]||(s[8]=[c("回复",-1)])]),_:1}),e(_,{type:"text",size:"small"},{default:a(()=>[...s[9]||(s[9]=[c("点赞",-1)])]),_:1})])])]))),128))])])])):(d(),u("div",jt,[e(K,{icon:"error",title:"文章不存在","sub-title":"抱歉，您访问的文章不存在或已被删除"},{extra:a(()=>[e(_,{type:"primary",onClick:s[1]||(s[1]=n=>r.$router.push("/home"))},{default:a(()=>[...s[10]||(s[10]=[c(" 返回首页 ",-1)])]),_:1})]),_:1})]))])}}},Wt=P(qt,[["__scopeId","data-v-a41f825e"]]);export{Wt as default};
